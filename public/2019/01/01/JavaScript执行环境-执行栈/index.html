<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> JavaScript执行环境-执行栈 · HarryPang's Blog</title><meta name="description" content="JavaScript执行环境-执行栈 - Harry Pang"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://github.com/ZhangQiangQQ/atom.xml" title="HarryPang's Blog"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">博客</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">归档</a></li><li class="nav-list-item"><a href="/2019/01/11/关于我" target="_self" class="nav-list-link">关于我</a></li><li class="nav-list-item"><a href="https://github.com/ZhangQiangQQ/" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">JavaScript执行环境-执行栈</h1><div class="post-info">2019年1月1日</div><div class="post-content"><p>#####1.1执行环境<br>执行环境可以简称为环境，可以理解为JS被解析和执行所在的外部环境。</p>
<p>#####1.1.1全局执行环境<br>全局执行环境是最外层的一个环境，根据宿主环境的不同，全局对象也会有所区别，比如在浏览器中全局环境是window，在node中全局环境就是这个文件的module对象。</p>
<p>#####1.1.2函数执行环境<br>每次调用一个函数时，都会创建一个新的执行环境，在这个函数内的任何声明都无法在该函数之外的地方访问</p>
<p>#####1.1.3Eval函数执行环境<br>在eval()函数中的代码，不建议使用</p>
<p>#####1.1.4 执行栈<br>我们先了解一下执行栈内的执行顺序：后进先出，意思就是最早来的最晚走，最后来的最先走（参考下图理解）<br><img src="https://user-gold-cdn.xitu.io/2018/12/21/167cf228b8c8df0f?w=555&amp;h=288&amp;f=png&amp;s=52150" alt="image.png"></p>
<blockquote>
<p>因为JavaScript在浏览器环境中的执行是单线程（就是一次只能做一件事，不能边吃饭边看电视，只能先吃饭再看电视），对于多个任务，只能采用任务队列的方式（就是先吃饭，一定要等吃完饭才能看电视）。</p>
</blockquote>
<p>举一个例子（暂时不用去看current execution context这一层，其实就是Execution Context N+1），</p>
<ol>
<li>调用 一个函数f1，执行流先进入全局环境<br>（Global Execution Context这一层）</li>
<li>f1的环境被推入环境栈中<br>（Execution Context N+1这一层按照绿色箭头进入）</li>
<li>这时候函数f1又调用了函数f2，f2的环境被推入环境栈中<br>（Execution Context N+2这一层按照绿色箭头进入）</li>
<li>f2执行完之后就立马离开执行栈<br>Execution Context N+2这一层按照红箭头离开</li>
<li>f1执行完之后在f2离开环境栈后再离开环境栈<br>Execution Context N+1这一层按照红箭头离开</li>
<li>全局环境不会消失，除非关闭浏览器或者关闭网页所以Global Execution Context这一层不会消失</li>
</ol>
<blockquote>
<p>看到这里，我们就能理解另外一个概念：执行环境的两个阶段</p>
<p>######1. 创建阶段</p>
<ul>
<li>当函数被调用，但是为执行内部代码之前:</li>
<li>创建一个作用域链</li>
<li>创建变量，函数和参数。</li>
<li>确定this的值。<br>######2, 执行阶段</li>
<li>赋值，引用函数，解释/执行代码。</li>
</ul>
</blockquote>
</div></article></div></main><footer><div class="paginator"><a href="/2019/01/01/前端进阶学习路径/" class="prev">PREV</a><a href="/2018/12/25/vue中AsyncAwait的使用示例/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2019 <a href="https://github.com/ZhangQiangQQ">Harry Pang</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>